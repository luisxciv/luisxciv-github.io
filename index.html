<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <title>Pylogin</title>
    <link rel="icon" href="res/img/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <link rel="stylesheet" media="screen and (max-width: 490px)" href="css/mobile.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
<div id="wrapper">
    <section class="left me">
        <!--TODO: work out how to relative links to work e.g. res/img/avatar.png -->
        <img src="https://avatars2.githubusercontent.com/u/22042789?s=460&amp;v=4" width="230" alt="Luis Garcia" class="avatar" />
        <article>
            <h2><font size="4"> Luis Garcia Calzada</font></h2>
            <h3>Information Security</h3>
            <nav id="social">
                <ul>
                    <li><a href="https://github.com/luisxciv"><img src="res/img/gh.svg" alt="My GitHub" /></a></li>
                    <li><a href="https://twitter.com/lusiboyz"><img src="res/img/tw.svg" alt="My Twitter" /></a></li>

                </ul>
                <ul>Other projects:</ul>
                <li><font size="3" color="#9370db"><a href="Syrans.html">Python Ransomware</a></font></li>
                <li><font size="3" color="#9370db"><a href="sqlite3db.html">sqlite3-db grabber</a></font></li>

            </nav>
        </article>
    </section>
    <section class="right" id="content">
        <article>
            <h1 class="title"> pentestlib: <span>a python penetration testing library</span></h1>
            <pre>@author luisxciv</pre>
            <p>The goal of this project is to build a library of pentest python scripts. You can find all of the scripts inside my pentestlib repo @ github.com/luisxciv/pentestlib.
            </p>
            <h2>third-party libraries: <span>Some of the scripts require the use of third-party libraries, you can use  pip  to easily install modules. </span></h2>

            <pre>

						<code class="cpp">
import nmap import pydf import python-nmap import pygeoip import mechanize import BeautifulSoup4 import python-bluez import bluetooth import python-obexftp</code>
					</pre>
            <h2>banner-grabbing</h2><span>The purpose of banner grabbing is to perform vulnerability analysis by obtaining information provided by the network host. The script iterates through a list of ports and range a subnet of IP's using range(0,255) and uses the socket.recv module to read the first 2048 bytes of the banner to check it against a vulnerable list of vulnerable banners.  </span></h3>
            <code class="cpp">
                    <h3>  Usage: bannergrabber.py vulnerablebanners.txt  </h3>
            </code>
                <pre>
						<code class="cpp">
import socket
import sys

def retbanner(ip, port):
    try:
        socket.setdefaulttimeout(2)
        s = socket.socket()
        s.connect((ip, port))
        banner = s.recv(2048)
        return banner
    except:
        return

def main():
    if len(sys.argv) == 2:
        filename = sys.argv[1]
        print
        "reading vulnerabilities from" + filename

    portlist = [21,22,80,443]
    for x in range(1,255):
        ip = '192.168.1.' + str(x)
        for port in portlist:
            banner = retbanner(ip, port)
            if banner:
                print
                '[+]' + ip + ":" + banner
                vulns(banner, filename)

def vulns(banner, filename):
    f = open(filename, 'r')
    for line in f.readlines():
        if line.strip('\n') in banner:
            print
            "Server is vulnerable" +banner.strip('/n')

if __name__ == '__main__':
    main()
						</code>
					</pre>
            </br>
            <h2>unix password-cracker</h2><span> "Unix stores the salt as the first two characters of the encrypted password." which is a poor salting technique. Using the same crypt() module we can do a dictionary attack by hashing the words and identifying the salt</span>
            <code class="cpp">
                    <h3>  Usage: add the /etc/passwd path  </h3>
            </code>
                <pre>
						<code class="c">
import crypt

def testpass(password):
    salt = password[0:2]    #This is assuming you know how the password was salted,
                            #UNIX uses crypt() which adds the same 2 char salt to every password
    dictionaryfile = open('dictionary.txt', 'r')
    for word in dictionaryfile.readlines():
        word = word.strip('\n')
        cryptword = crypt.crypt(word,salt)
        if cryptword == password:
            print
            'found password:' + word + "\n"
            return
        print
        'password not found'
        return
def main():
    passwordfile = open('passwords.txt')
    for line in passwordfile.readlines():
        if ":" in line:
            username = line.split(':')[0]
            password = line.split(':')[1].strip(' ')
            print
            'cracking password for' + username
            testpass(password)

if __name__ == '__main__':
    main()
						</code>
					</pre>
                </br>




        </article>
        <hr />
    </section>
</div>
</body>
</html>
